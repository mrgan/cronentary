<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<title>Cronentary</title>
	<meta name="apple-mobile-web-app-title" content="Cronentary">
	<meta name="description" content="The soothing sounds of David Cronenberg's DVD commentary">
	<meta name="keywords" content="david cronenberg, cronenberg, commentary, dvd, existenx, videodrome, rabid, scanners">
	
	<meta property="og:title" content="Cronentary" />
	<!-- <meta property="og:url" content="https://" /> -->
	<meta property="og:image" content="https://mrgan.github.io/cronentary/images/card.png" />
	<meta property="og:image:width" content="500" />
	<meta property="og:image:height" content="250" />
	<meta property="og:description" content="The soothing sounds of David Cronenberg's DVD commentary" />
	
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="Cronentary">
	<meta name="twitter:description" content="The soothing sounds of David Cronenberg's DVD commentary">
	<meta name="twitter:image" content="https://mrgan.github.io/cronentary/images/card.png">
	
	<link rel="apple-touch-icon-precomposed" href="images/icon.png" />
	<link rel="icon" type="image/png" href="images/icon-small.png">
	
	<style>
	
	:root
	{	
		--page-bg: #f14b31;
		--text: #fef210;
	}
	
	/* P3 variants */
	@supports (color: color(display-p3 1 1 1 / 1))
	{
		:root
		{
			--page-bg: color(display-p3 0.945 0.294 0.192);
		}		
	}
	
	body
	{
		background-color: var(--page-bg);
		color: var(--text);
			
		padding-top: 2vh;
	}
	
	h1#title
	{
		color: transparent;
		text-indent: -9999px;

		position: relative;
		height: 2.5em;
		max-width: 80%;
		margin: 1em auto 1em auto;

		background-repeat: no-repeat;
		background-position: center center;
		background-size: contain;
		background-image: url('images/title.png');
		
		pointer-events: none;
	}
	
	main
	{		
		position: absolute;
		display: grid;
		place-content: center;
		
		top: 0;
		left: 0;		
		width: 100%;
		height: 100%; */
	}
	
	#bed
	{
		width: 96%;
		max-width: 50em;
		margin: 0 auto 1em auto;
		
		pointer-events: none;
	}
	
	#controls
	{				
		width: 100%;
		margin: 0 auto -8vh auto;
		text-align: center;
		
		/* background: yellow; */
	}
		#controls .control
		{
			display: inline-block;			
			width: auto;
			width: 30vw;
			max-width: 40%;
			margin: 0 10% 0 auto;
		}
		#controls .control.hidden
		{
			display: none;
		}
		
		.blobby
		{
			animation-duration: 4000ms;
			animation-iteration-count: infinite;
			animation-timing-function: steps(5, jump-both);
			animation-direction: alternate;
			animation-name: blobble;
			transform: scale(1,1);
		}
			@keyframes blobble
			{
				0% { transform: scale(1,1); }
				30% { transform: scale(1.08, .93); }
				70% { transform: scale(.94, 1.12);}
				100% { transform: scale(1.07, .95);}
			}
	
	footer
	{
		margin-top: 1em;
		text-align: center;
		color: var(--subtle);
	}
	
	audio
	{
		width: 60%;
		margin: 2em auto 1em auto;		
	}
	
	/* Desktop scale */
	@media screen and (min-width: 640px)
	{
		body
		{
			font-size: 1em;	
			padding-top: 6vh;
		}
	}
	
	@media (prefers-color-scheme: dark)
	{
		:root
		{
			--page-bg: #000000;
			--text: #e8e8e8;
			--bright-bg: black;
			--subtle: #666666;
		}
		
		
	}
	
	</style>
	
	<script>
		
		function shuffle(array)
		{
			for (let i = array.length - 1; i > 0; i--)
			{
				const j = Math.floor(Math.random() * (i + 1));
				[array[i], array[j]] = [array[j], array[i]];
			}
		}
		
		// Start
		
		var c = 0;
		var autoplay = false;
		var firstLoaded = false;
		
		const clips = [
			"clips/Crash clips_A1-0026.mp3",	
			"clips/Crash clips_A1-0035.mp3",	
			"clips/Crash clips_A1-0040.mp3",	
			"clips/Crash clips_A1-0043.mp3",	
			"clips/Crash clips_A1-0077.mp3"	
		];
		shuffle(clips);
		
		const audioElement = new Audio();
		
		// Load 
		audioElement.addEventListener("canplaythrough", () =>
		{
			if (!firstLoaded)
			{				
				document.getElementById('btnPlay').classList.toggle('hidden');		
				firstLoaded = true;				
			}
			
			console.log("Clip ready. Length: " + audioElement.duration)
		
			if (autoplay)
			{
				playClip();
			}
		});
		
		// Clip finished
		audioElement.addEventListener("ended", () =>
		{
			c++;
			if (c >= clips.length)
			{
				c = 0;
			}
			console.log("Next up, " + clips[c])
			loadClip();
		});

		
		function loadClip()
		{			
			audioElement.src = clips[c];
			audioElement.load();
			console.log("Loaded " + clips[c]);
		}
		
		function playClip()
		{
			audioElement.play();
			console.log("Playing " + clips[c]);	  
		}
		
		function pauseClip()
		{
			audioElement.pause();
			console.log("Pausing " + clips[c]);	  
		}
		
		function playPause()
		{
			console.log('Attempting to play/pause');
			
			if (audioElement.paused)
			{
				playClip();
				autoplay = true; // the first time the user clicks play, they opt into autoplay
			}
			else
			{
				pauseClip();	
				autoplay = false;
			}
			document.getElementById('btnPlay').classList.toggle('hidden');			
			document.getElementById('btnPause').classList.toggle('hidden');
			document.getElementById('btnPause').classList.toggle('blobby');
		}
		
		function init()
		{
			console.log('Entered page.')
			loadClip();			
		}
		
		
		
	</script>
	
</head>

<body class="" onload="init()">
	
	<main id="content">
		
		<header>
			
			<h1 id="title">
				CRONENTARY
			</h1>    	
				
		</header>
		
		<div id="controls">
			<img id="btnPlay" class="control hidden" src="images/play.png" onclick="playPause()">
			<img id="btnPause" class="control hidden" src="images/pause.png" onclick="playPause()">
		</div>
		
		<img src="images/bed.png" id="bed">
		
	</main>
	
	<footer>
		
	</footer>
	
</body>

<script>


</script>

</html>